<div class="container">
  <div class="card-large">
    <h2>Formulaire de v≈ìux</h2>
    
    <!-- Bandeau infos √©l√®ve -->
    <div class="bandeau-eleve" *ngIf="eleve">
      <span>üë§ {{ eleve.prenom }} {{ eleve.nom }}</span>
      <span>üè´ {{ eleve.lycee }}</span>
      <span class="badge">‚è∞ {{ eleve.demiJournee }}</span>
    </div>
    
    <!-- Loader -->
    <div class="loader" *ngIf="isLoading">
      Chargement des activit√©s...
    </div>
    
    <!-- Affichage des erreurs de validation -->
    <div *ngIf="erreurs.length > 0" class="alert-erreur">
      <ul>
        <li *ngFor="let erreur of erreurs">{{ erreur }}</li>
      </ul>
    </div>
    
    <form [formGroup]="formulaire" *ngIf="!isLoading && activites">
      
      <!-- SECTION V≈íUX 1 ET 2 -->
      <div class="section-voeux">
        <h3>üìå Vos 2 premiers v≈ìux (Conf√©rences uniquement)</h3>
        <p class="info">Choisissez 2 conf√©rences diff√©rentes parmi les 19 disponibles</p>
        
        <div class="form-group">
          <label for="voeu1">V≈ìu n¬∞1 - Conf√©rence *</label>
          <select id="voeu1" formControlName="conferenceVoeu1" class="select-input">
            <option [value]="null">-- Choisissez une conf√©rence --</option>
            <option *ngFor="let conf of activites.conferences" [value]="conf.id">
              {{ conf.titre }}
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="voeu2">V≈ìu n¬∞2 - Conf√©rence *</label>
          <select id="voeu2" formControlName="conferenceVoeu2" class="select-input">
            <option [value]="null">-- Choisissez une conf√©rence --</option>
            <option *ngFor="let conf of activites.conferences" [value]="conf.id">
              {{ conf.titre }}
            </option>
          </select>
        </div>
      </div>
      
      <!-- SECTION V≈íUX 3-4-5 -->
      <div class="section-voeux">
        <h3>üìå Vos 3 v≈ìux suivants</h3>
        <p class="info">
          Vous pouvez choisir parmi les 17 conf√©rences restantes, 
          les {{ activites.tablesRondes.length }} tables rondes ou 
          les {{ activites.flashsMetiers.length }} flashs m√©tiers
        </p>
        
        <div class="form-group">
          <label for="voeu3">V≈ìu n¬∞3 *</label>
          <select id="voeu3" formControlName="activiteVoeu3" class="select-input">
            <option [value]="null">-- Choisissez une activit√© --</option>
            <optgroup label="Conf√©rences">
              <option *ngFor="let conf of activites.conferences" [value]="conf.id">
                {{ conf.titre }}
              </option>
            </optgroup>
            <optgroup label="Tables rondes">
              <option *ngFor="let tr of activites.tablesRondes" [value]="tr.id">
                {{ tr.titre }}
              </option>
            </optgroup>
            <optgroup label="Flashs m√©tiers">
              <option *ngFor="let fm of activites.flashsMetiers" [value]="fm.id">
                {{ fm.titre }}
              </option>
            </optgroup>
          </select>
        </div>
        
        <div class="form-group">
          <label for="voeu4">V≈ìu n¬∞4 *</label>
          <select id="voeu4" formControlName="activiteVoeu4" class="select-input">
            <option [value]="null">-- Choisissez une activit√© --</option>
            <optgroup label="Conf√©rences">
              <option *ngFor="let conf of activites.conferences" [value]="conf.id">
                {{ conf.titre }}
              </option>
            </optgroup>
            <optgroup label="Tables rondes">
              <option *ngFor="let tr of activites.tablesRondes" [value]="tr.id">
                {{ tr.titre }}
              </option>
            </optgroup>
            <optgroup label="Flashs m√©tiers">
              <option *ngFor="let fm of activites.flashsMetiers" [value]="fm.id">
                {{ fm.titre }}
              </option>
            </optgroup>
          </select>
        </div>
        
        <div class="form-group">
          <label for="voeu5">V≈ìu n¬∞5 *</label>
          <select id="voeu5" formControlName="activiteVoeu5" class="select-input">
            <option [value]="null">-- Choisissez une activit√© --</option>
            <optgroup label="Conf√©rences">
              <option *ngFor="let conf of activites.conferences" [value]="conf.id">
                {{ conf.titre }}
              </option>
            </optgroup>
            <optgroup label="Tables rondes">
              <option *ngFor="let tr of activites.tablesRondes" [value]="tr.id">
                {{ tr.titre }}
              </option>
            </optgroup>
            <optgroup label="Flashs m√©tiers">
              <option *ngFor="let fm of activites.flashsMetiers" [value]="fm.id">
                {{ fm.titre }}
              </option>
            </optgroup>
          </select>
        </div>
      </div>
      
      <!-- ACTIONS -->
      <div class="actions">
        <button type="button" (click)="retour()" class="btn-secondary" [disabled]="isSubmitting">
          ‚Üê Retour
        </button>
        <button 
          type="button" 
          (click)="soumettre()" 
          [disabled]="formulaire.invalid || isSubmitting" 
          class="btn-primary">
          <span *ngIf="!isSubmitting">Soumettre mes v≈ìux ‚úì</span>
          <span *ngIf="isSubmitting">Soumission en cours...</span>
        </button>
      </div>
    </form>
  </div>
</div>
